{{- $item := .item -}}
{{- if not $item -}}
  {{- return -}}
{{- end -}}

{{- $cardID := "" -}}
{{- with $item.File }}{{ $cardID = printf "tech-card-%s" .UniqueID }}{{ else }}{{ $cardID = printf "tech-card-%s" (anchorize $item.Title) }}{{ end }}

{{- $summary := "" -}}
{{- with $item.Params.summary }}
  {{- $summary = . | plainify -}}
{{- else }}
  {{- with $item.Summary }}
    {{- $summary = . | plainify -}}
  {{- end -}}
{{- end -}}
{{- if gt (len $summary) 220 }}{{ $summary = truncate 220 $summary }}{{ end -}}

{{- $overview := "" -}}
{{- with $item.Params.overview }}
  {{- $overview = . | plainify -}}
{{- end -}}
{{- if eq $overview "" }}
  {{- if ne $summary "" }}
    {{- $overview = $summary -}}
  {{- end -}}
{{- end -}}
{{- if eq $overview "" }}
  {{- with $item.Params.description }}
    {{- $overview = . | plainify -}}
  {{- end -}}
{{- end -}}
{{- if gt (len $overview) 220 }}{{ $overview = truncate 220 $overview }}{{ end -}}

{{- $goals := slice -}}
{{- with $item.Params.goals }}{{ $goals = . }}{{ end -}}

{{- $section := $item.Section | default "" -}}
{{- $eyebrow := "" -}}
{{- with $item.Params.topic }}{{ $eyebrow = . }}{{ end -}}
{{- if eq $eyebrow "" }}
  {{- with $item.Params.instructor }}{{ $eyebrow = . }}{{ end -}}
{{- end -}}
{{- if eq $eyebrow "" }}
  {{- $eyebrow = cond (eq $section "related-courses") "관련 과목" "강의 정보" -}}
{{- end -}}

<article class="showcase-card" role="article" aria-labelledby="{{ $cardID }}">
  <a class="showcase-card__inner" href="{{ $item.RelPermalink }}" aria-labelledby="{{ $cardID }}">
    <div class="showcase-card__content">
      <div class="showcase-card__eyebrow">
        <span>{{ $eyebrow }}</span>
      </div>

      <h3 id="{{ $cardID }}" class="showcase-card__title">
        {{ $item.Title }}
      </h3>

      {{- if ne $overview "" }}
        <div class="showcase-card__section">
          <span class="showcase-card__section-label">강의 개요</span>
          <p class="showcase-card__overview">
            {{ $overview }}
          </p>
        </div>
      {{- end }}

      {{- if gt (len $goals) 0 }}
        <div class="showcase-card__section">
          <span class="showcase-card__section-label">강의 목표</span>
          <ul class="showcase-card__goals">
            {{- range first 3 $goals }}
              {{- $goalText := . | plainify | strings.TrimSpace -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 1️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 2️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 3️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 4️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 5️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 6️⃣ :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 1:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 2:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 3:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 4:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 5:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 6:" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 1 :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 2 :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 3 :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 4 :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 5 :" -}}
              {{- $goalText = strings.TrimPrefix $goalText "Goal 6 :" -}}
              {{- $goalText = strings.TrimLeft $goalText ":：-–— " -}}
              <li>{{ $goalText }}</li>
            {{- end }}
          </ul>
        </div>
      {{- end }}

      <span class="showcase-card__cta-inline">
        과목 상세 보기
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M5 12h14M13 6l6 6-6 6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </span>
    </div>
  </a>
</article>
